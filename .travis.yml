language: android
jdk: oraclejdk7

branches:
   only:
      - unstable

android:
   components:
      - build-tools-21.1.1
      - android-21
      - sys-img-x86-android-21
env:
   global:
      # install timeout in minutes
      - ADB_INSTALL_TIMEOUT=8

# Create and start the emulator
before_script:
   - sudo apt-get update -qq
   - sudo apt-get install -qq libstdc++6:i386 lib32z1 expect
   - sudo apt-get install qemu-kvm libvirt-bin ubuntu-vm-builder bridge-utils
   - echo no | android create avd --force -n test -t android-21  --abi default/x86
   - emulator -avd test -no-skin -no-audio -no-window &
   - android-wait-for-emulator
   - adb shell inout keyevent 82 & 

script:
   - ./gradlew connectedAndroidTest -PdisablePreDex
   

    
